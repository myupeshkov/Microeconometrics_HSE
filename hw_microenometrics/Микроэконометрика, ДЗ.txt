 Микроэконометрика  Домашнее задание  I. Оформление и сроки  1. На титульном листе должны быть указаны: имя, фамилия, группа и номер домашнего задания. 2. Таблицы и графики должны быть подписаны и пронумерованы. Все оси подписываются на русском языке. 3. Все приведенные графики и таблицы должны быть проинтерпретированы со ссылкой на их номер. 4. Задание можно выполнять, используя любые программные средства (не обязательно R или Stata). К работе прикладываются файлы (R-файл, do-файл и т.д.), при помощи которых можно воспроизвести результаты вашего исследования. Из содержания приложенного файла должно быть ясно, какая часть кода или выполненных операций относится к какому заданию. Например, в .R или .do файле можно расставить комментарии по поводу того, какая часть кода относится к тому или иному заданию. 5. Работу следует отправить на почту studypotanin@gmail.com не позднее чем 01.11.2021 до 8.00 утра включительно. Тема письма обязательно должна иметь следующий формат “Фамилия_Имя_Группа_Микроэконометрика”, например, “Потанин_Богдан_123_Микроэконометрика”. В противном случае отправленное вами задание скорее всего не будет получено. 6. Все пункты работы должны быть выполнены последовательно с указанием текста задания. То есть оформление должно быть следующим: Задание №1. Текст задания. Ваш текст. Задание №2. Текст задания. Ваш текст. … Задание №N. Текст задания. Ваш текст. Где N – номер последнего задания. 7. Все задания выполняются индивидуально. 8. Все переменные в таблицах и на графиках должны быть понятным образом обозначены. Например, название переменной ufj15 — не подходит, даже если в тексте указано, что именно данная переменная означает. Если эта переменная относится к, например, полу, то её следует назвать male, gender или sex, а также дать интерпретацию кодам, например, 0 – женщина, 1 – мужчина. 9. Работа отправляется только в pdf формате и обязательно должна иметь название “Фамилия_Имя_Группа_Микроэконометрика.pdf”, например, “Потанин_Богдан_123_Микроэконометрика.pdf”. 10. Во всех заданиях, где требуется оценить что-либо для индивида с произвольными характеристиками, необходимо, предварительно, выписать в форме таблицы характеристики соответствующего индивида. Если характеристики произвольного индивида на протяжении работы не меняются, то можно указать их в отдельной таблице в приложении и ссылаться на нее на протяжении работы. 11. При проведении всех тестов необходимо в тексте работы указать нулевую гипотезу и тестовую статистику, а также её асимптотическое распределение при верной нулевой гипотезе. Исключение составляют лишь обычные тесты о значимости одного регрессионного коэффициента, по поводу которых достаточно привести лишь краткую устную интерпретацию полученного результата. 12. Формулы можно как набирать на компьютере, так и вставлять картинкой с аккуратным рукописным тестом. Копировать формулы из других источников нельзя.  II. Задания  В данной работе вы будете изучать, как различные факторы влияют на вероятность того, что индивид оформит подписку на онлайн кинотеатр. Для этого используйте данные “homework.excel”. Чтобы считать соответствующие данные в R необходимо подключить библиотеку “xlsx” и воспользоваться функцией “read.xlsx”. Данные содержат информацию о следующих индивидуальных характеристиках: • income — доход • age — возраст • internet — доля свободного времени, проводимого в интернете • series — количество просмотренных за год сериалов • health — субъективная оценка здоровья •male—половая принадлежность•marriage—состоит в официальном браке•residence—место проживания•cat—фактналичиякота•news—субъективнаяоценкастепени,вкоторой индивидинтересуетсяновостями•sub—фактналичияподписки наонлайн кинотеатр(зависимаяпеременная)•TV—индивид смотрит телевизор не реже раза внеделюЧасть1. Теория и гипотезы.1.1.Выберите независимые переменные.Краткотеоретическиобоснуйте выборкаждойизних: не обязательнососсылкамина литературу,достаточноздравогосмысла.Укажите икраткообоснуйте предполагаемые направленияэффектов.Приэтомвампонадобитсякакминимум одна непрерывнаяпеременная(например, возрастилидоход)и одна даммипеременная(например, половая принадлежностьилибрак).Не рекомендуетсябратьбольше трехразличныхнезависимыхпеременных,несчитаяихнелинейныхпреобразований:квадрат,логарифм,перемножение с цельюполученияпеременнойвзаимодействия и т.д.1.2. Сформулируйтепокрайней мереоднугипотезуоналичии эффектавзаимодействия инелинейного эффекта(например, квадратичного). Теоретическиобоснуйте выдвигаемые вамигипотезы.Включите соответствующие переменные ввашумодель.Приэтомпеременная, входящая нелинейно, должнаиметьи линейнуючасть, например, P48#yIS1.Часть2.Линейно-вероятностная модель.2.1.Оцените линейно-вероятностнуюмодель,предварительнозаписаврегрессионноеуравнение.Укажите оцениваемые параметрыиметодполученияоценок.Результатпредставьте вформе таблицы(можно,например,использоватьвыдачуизstata, Rилиpython).2.2.Перечислите основные недостаткилинейно-вероятностноймодели. Напишите, можно лиинтерпретироватьоценки коэффициентов,ихзначимость(сиспользованиемобычной оценки ковариационной матрицы),коэффициентдетерминации и F-статистику? Если да, то приведите интерпретацию, а если нет, то объясните (без непосредственной реализации), почему она в данном случае невозможна и предложите альтернативный способ оценки качества модели. 2.3. Оцените и проинтерпретируйте, независимо от значимости, предельные эффекты на вероятность подписки каждой из используемых вами независимых переменных, предварительно записав формулы, по которым осуществлялся расчет. Результат представьте в форме таблицы, где для переменных, входящих нелинейно, рассчитан средний предельный эффект. Также, для этих переменных должно быть указано, при каких значениях независимой переменной их предельный эффект является положительным, а при каких — отрицательным.  Часть 3. Пробит модель.  3.1. Оцените пробит модель, предварительно записав максимизируемую функцию правдоподобия, указав оцениваемые параметры и метод получения оценок, а также их основные свойства. Результат представьте в форме таблицы (можно, например, использовать выдачу из stata, R или python). 3.2. Проинтерпретируйте оценки коэффициентов для каждой независимой переменной. Поясните, как полученные результаты соотносятся с высказанными вами ранее предположениями. 3.3. Оцените вероятность наличия подписки для индивида с произвольными (например, вашими) характеристиками. Запишите формулу, по которой осуществлялся расчет (подставьте в нее полученные реализации оценок). 3.4. Для произвольных непрерывной и бинарной независимых переменных оцените средний предельный эффект на вероятность наличия подписки, предварительно записав формулы (с подставленными реализациями оценок), по которым осуществлялся расчет. Результат представьте в форме таблицы. 3.5. Посчитайте долю верных предсказаний и сопоставьте её с результатом наивного прогноза и линейно-вероятностной модели. Сделайте вывод о предсказательной силе пробит модели. 3.6. На уровне значимости 5% проверьте гипотезу о том, что предельный эффект на вероятность наличия подписки по произвольной (на ваш выбор) независимой переменной является значимым для индивида с произвольными характеристиками. 3.7*. Повторите предыдущий пункт для переменной, имеющей взаимодействие.  Часть 4. Тестирование корректности спецификации пробит модели.  4.1. При помощи LM-теста проверьте гипотезу о соблюдении допущения о нормальном распределении случайных ошибок в пробит модели. Укажите, к каким негативным последствиям может привести нарушение данного допущения. 4.2. Предположите, какие переменные могут влиять на дисперсию случайной ошибки. При этом по крайней мере одна переменная должна входить и в линейный индекс основного уравнения, и в линейный индекс уравнения дисперсии. При помощи LR теста проверьте гипотезу о гомоскедастичности случайных ошибок. Запишите, к каким негативным последствиям может привести нарушение данного допущения. Объясните преимущество LM теста над LR тестом в данном случае. 4.3. Для модели с гетероскедастичной случайной ошибкой рассчитайте предельный эффект на вероятность занятости и на дисперсию случайной ошибки по переменной, входящей и в основное уравнение, и уравнение дисперсии. Предварительно запишите формулы, по которым осуществляется расчет. 4.4. Для переменной, входящей в линейный индекс нелинейно, при помощи LR теста проверьте гипотезы о том, что: 1) Коэффициент при линейной части равняется нулю 2) Оба коэффициента равняются нулю 3) Коэффициент при линейной части совпадает по знаку и в k раз больше (по модулю), чем при нелинейной, где можно выбрать произвольным, указав выбранное значение. P74#yIS10k≠4) Коэффициент при линейной части совпадает по знаку и в k раз больше, чем при нелинейной, а коэффициент при произвольной бинарной переменной равняется t, где можно выбрать произвольным, указав выбранное значение. P75#yIS10t≠4.5. При помощи LR теста проверьте, можно ли оценивать совместную модель для мужчин и для женщин, либо стоит оценить две различные модели. 4.6*. При помощи LR теста проверьте, можно ли оценивать совместную модель для людей, проживающих в населенных пунктах различного типа (рассмотрите все три возможных типа населенного пункта).  Часть 5. Логит модель.  5.1. Оцените логит модель, предварительно записав максимизируемую функцию правдоподобия и указав, чем логит модель отличается от пробит модели. Результат представьте вформе таблицы(можно,например,использоватьвыдачуизstata, Rилиpython).5.2. Проинтерпретируйте значенияоценокизменений вотношенияхшансовпо каждойнезависимой переменной, входящей линейно.5.3*. Запишите выражениядлярасчетаизменений вотношенияхшансовпокаждойнезависимой переменной,входящей нелинейно.Рассчитайте соответствующие предельные эффектыдляиндивида с произвольнымихарактеристиками.Результатырасчетовпредставьте в форме таблицы.5.4**.Дляпроизвольной независимойпеременной,входящей нелинейно, проверьтегипотезу о том, что при её изменениинаединицуотношение шансоввозрастетна 10%.Часть6. Система бинарных уравнений.6.1.Оценитесистемубинарныхуравнений, одно изкоторых описывает вероятностьподписки, авторое—вероятностьтого, что индивидсмотриттелевизор нережеразавнеделю. Приэтомобауравнения должныиметьпо крайнеймереоднуобщуюиоднуразличающуюсянезависимуюпеременную.При необходимости спецификацияуравненияподпискиможет отличаться от той, что использовалась в предыдущих разделах.6.2. Проинтерпретируйтеоценки коэффициентовпри независимыхпеременныхикоэффициентакорреляции междуслучайными ошибками рассматриваемыхуравнений.6.3. ПрипомощиLRтестапроверьте, имеется линеобходимостьвтом, чтобыоцениватьоба уравнениясовместно.6.4. Для индивида с произвольнымихарактеристикамиоцените:1) Вероятностьподписки2)Вероятность того, что индивид смотриттелевизор по крайней мере раз в неделю3)Вероятностьтого, что индивиди имеетподписку,и смотриттелевизорнережераза внеделю4)Вероятностьтого, чтоуиндивидаимеетсяподписка, приусловии, что онсмотриттелевизорреже раза внеделю6.5**.Дляиндивидаспроизвольнымихарактеристиками оценитепредельныйэффектобщейдлядвухуравненийпеременнойна вероятностьтого, что индивидимеетподписку,при условии,чтововторомуравнении зависимаябинарнаяпеременнаяприметединичноезначение.Запишите использовавшуюся для расчетов формулу.Часть 7. Сравнение моделей  7.1. Определите, какая из оцененных вами моделей обладает наибольшей предсказательной силой. 7.2. Выберите лучшую из оцененных вами моделей руководствуясь информационными критериями. 7.3**. Руководствуясь информационным критерием Акаике и качеством вневыборочного прогноза (разделите выборку на тестовую и тренировочную части) определите оптимальные маржинальные распределения для случайных ошибок и копулу. Укажите, совпадают ли лучшие модели, выбранные по AIC и вневыборочному прогнозу. В данном задании рассмотрите по крайней мере 5 различных копул и две различные комбинации маржинальных распределений случайных ошибок. Результат представьте в форме таблицы.  Часть 8. Модель бинарного выбора со случайными ошибками, имеющими распределение Стьюдента   Рассмотрим распределение Стьюдента с df степенями свободы, где df равняется сумме букв в ваших имени и фамилии.   8.1***. Используя воображение придумайте и кратко опишите экономическую задачу, для решения которой необходимо применить модель бинарного выбора. Например, можно рассмотреть влияние различных факторов на вероятность дефолта банка. Укажите зависимую переменную и по крайней мере три независимых, а также кратко опишите предполагаемый механизм влияния независимых переменных на зависимую.  8.2***. Симулируйте процесс генерации данных, соответствующий вашей задаче в логике бинарной модели со случайными ошибками, имеющими распределение Стьюдента (по аналогии с тем, как это делалось для обычной пробит модели для дефолта на семинаре). В тексте работы этот пункт отражать не нужно, достаточно реализовать его в коде. Все дальнейшие пункты выполняются на симулированных данных из выборки объемом 5000 наблюдений. Перед началом симуляций необходимо указать set.seed(123). 8.3***. Оцените параметры вашей модели с использованием бинарной модели со случайными ошибками, имеющими распределение Стьюдента с df степенями свободы. Результат представьтев форме таблицы, содержащей оценки коэффициентов иp-valueтестовназначимость.8.4***. Напишитефункцию,позволяющуюрассчитыватьпредельный эффектнавероятность занятостипо произвольнойнепрерывной переменной в отношении индивидаспроизвольными характеристиками:для простоты переменными, входящими нелинейно, можно пренебречь. При помощи данной функции оцените предельный эффектпроизвольной непрерывной переменнойна вероятностьуспеха дляиндивидаспроизвольнымихарактеристиками.8.5***.Симулируйте процесс генерации данных таким образом, чтобы дисперсия случайной ошибкизависела покрайнеймере оддвухнезависимыхпеременных,одна изкоторыхне входит в основноеуравнение. Выполните одно заданиенавыбор:1) Напишитефункцию,осуществляющуюLMтестна гомоскедастичностьслучайных ошибокв рамках вашей модели.Воспользуйтесьвашейфункцией иопишитеполученный результат.2)Напишите функцию, при помощи которой можно оценитьпараметры моделибинарного выбора сгетероскедастичнойслучайнойошибкой,имеющейраспределение Стьюдентас dfстепенямисвободы.При помощи вашей функции иLRтеста проверьте гипотезу о гомоскедастичности случайных ошибок.